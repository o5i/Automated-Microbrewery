<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>
<head>
   <TITLE>Modbus Slave C++ Library: MbusTcpSlaveProtocol Class Reference</TITLE>
   <LINK href="style.css" rel="stylesheet" type="text/css">
</head>
<body>
   <table width="100%"><tr>
   <td valign=bottom><b><font color=black size=4>
      FieldTalk<small><sup>&#153;</sup></small> Modbus<small><sup>&reg;</sup></small> Slave Library<br>
      C++ Editions</font></b></td>
   <td valign=bottom align=right>
      <a href="http://www.focus-sw.com">
      <img src="focuslogo50x200.png" border=0 size="50%"
       alt="FOCUS Software Engineering" ></a></td>
   </tr></table>
   <hr size=4 noshade color=gray>

<!-- Generated by Doxygen 1.4.1 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>MbusTcpSlaveProtocol Class Reference<br>
<small>
[<a class="el" href="group__mbusslavetcp.html">MODBUS/TCP Protocol</a>]</small>
</h1>Inheritance diagram for MbusTcpSlaveProtocol:<p><center><img src="classMbusTcpSlaveProtocol__inherit__graph.gif" border="0" usemap="#MbusTcpSlaveProtocol__inherit__map" alt="Inheritance graph"></center>
<map name="MbusTcpSlaveProtocol__inherit__map">
<area href="classMbusSlaveServer.html" shape="rect" coords="27,7,211,503" alt="">
</map>
Collaboration diagram for MbusTcpSlaveProtocol:<p><center><img src="classMbusTcpSlaveProtocol__coll__graph.gif" border="0" usemap="#MbusTcpSlaveProtocol__coll__map" alt="Collaboration graph"></center>
<map name="MbusTcpSlaveProtocol__coll__map">
<area href="classMbusSlaveServer.html" shape="rect" coords="27,7,211,503" alt="">
</map>
<a href="classMbusTcpSlaveProtocol-members.html">List of all members.</a><hr><a name="_details"></a><h2>Detailed Description</h2>
MODBUS/TCP Slave Protocol class. 
<p>
This class realises the MODBUS/TCP slave protocol. It provides functions to start-up and to execute the server engine. This server engine can handle multiple master connections and is implemented as a single threaded TCP server. Upon receipt of a valid master query the server engine calls Data Provider methods to exchange data with the user application. For a more detailed description which Modbus data and control functions have been implemented in the server engine see section <a class="el" href="group__mbusslave.html">Server Functions common to all Protocol Flavours</a>.<p>
<dl compact><dt><b>See also:</b></dt><dd><a class="el" href="group__mbusslave.html">Server Functions common to all Protocol Flavours</a>, <a class="el" href="classMbusSlaveServer.html">MbusSlaveServer</a> </dd></dl>

<p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>MODBUS/TCP Server Management Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_0">MbusTcpSlaveProtocol</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructs a MbusTcpSlaveProtocol object.  <a href="#MbusTcpSlaveProtocolz29_0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_1">MbusTcpSlaveProtocol</a> (<a class="el" href="classMbusDataTableInterface.html">MbusDataTableInterface</a> *dataTablePtr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructs a MbusTcpSlaveProtocol object data and associates it with a Data Provider.  <a href="#MbusTcpSlaveProtocolz29_1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_2">startupServer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts the Modbus server into operation.  <a href="#MbusTcpSlaveProtocolz29_2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_3">startupServer</a> (const char *const hostName)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts the Modbus server into operation.  <a href="#MbusTcpSlaveProtocolz29_3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_4">startupServer</a> (int slaveAddr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts the Modbus server into operation using a single slave address and data table.  <a href="#MbusTcpSlaveProtocolz29_4"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_5">startupServer</a> (int slaveAddr, const char *const hostName)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Puts the Modbus server into operation using a single slave address and data table.  <a href="#MbusTcpSlaveProtocolz29_5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_6">shutdownServer</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Shuts down the Modbus server.  <a href="#MbusTcpSlaveProtocolz29_6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_7">serverLoop</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">MODBUS/TCP slave server loop.  <a href="#MbusTcpSlaveProtocolz29_7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_8">isStarted</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns if server has been started up.  <a href="#MbusTcpSlaveProtocolz29_8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_9">getConnectionStatus</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks if a Modbus master is polling periodically.  <a href="#MbusTcpSlaveProtocolz29_9"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_10">setPort</a> (unsigned short portNo)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the TCP port number to be used by the protocol.  <a href="#MbusTcpSlaveProtocolz29_10"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_11">installIpAddrValidationCallBack</a> (int(*f)(char *masterIpAddrSz))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function installs a callback handler for validating a master's IP address.  <a href="#MbusTcpSlaveProtocolz29_11"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_12">getPort</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the TCP port number used by the protocol.  <a href="#MbusTcpSlaveProtocolz29_12"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Server Management Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga0">addDataTable</a> (int slaveAddr, <a class="el" href="classMbusDataTableInterface.html">MbusDataTableInterface</a> *dataTablePtr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Associates a protocol object with a Data Provider and a slave address.  <a href="group__mbusslave.html#ga0"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Protocol Configuration</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga1">setTimeout</a> (long timeOut)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Configures master transmit time-out supervision.  <a href="group__mbusslave.html#ga1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga4">getTimeout</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the master time-out supervision value.  <a href="group__mbusslave.html#ga4"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Transmission Statistic Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga2">getTotalCounter</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns how often a message transfer has been executed.  <a href="group__mbusslave.html#ga2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ga5" doxytag="MbusTcpSlaveProtocol::resetTotalCounter"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga5">resetTotalCounter</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resets total message transfer counter. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">unsigned long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga6">getSuccessCounter</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns how often a message transfer was successful.  <a href="group__mbusslave.html#ga6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ga7" doxytag="MbusTcpSlaveProtocol::resetSuccessCounter"></a>
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga7">resetSuccessCounter</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resets successful message transfer counter. <br></td></tr>
<tr><td colspan="2"><br><h2>Utility Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mbusslave.html#ga3">getPackageVersion</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the package version number.  <a href="group__mbusslave.html#ga3"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="MbusTcpSlaveProtocolz29_0" doxytag="MbusTcpSlaveProtocol::MbusTcpSlaveProtocol"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="classMbusTcpSlaveProtocol.html">MbusTcpSlaveProtocol</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructs a MbusTcpSlaveProtocol object. 
<p>
The association with a Data Provider is done after construction using the addDataTable method.     </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_1" doxytag="MbusTcpSlaveProtocol::MbusTcpSlaveProtocol"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"><a class="el" href="classMbusTcpSlaveProtocol.html">MbusTcpSlaveProtocol</a>           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classMbusDataTableInterface.html">MbusDataTableInterface</a> *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>dataTablePtr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Constructs a MbusTcpSlaveProtocol object data and associates it with a Data Provider. 
<p>
Function is kept for compatibility with previous API versions, do not use for new implementations.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dataTablePtr</em>&nbsp;</td><td>Modbus data table pointer. Must point to a Data Provider object derived from the <a class="el" href="classMbusDataTableInterface.html">MbusDataTableInterface</a> class. The Data Provider is the interface between your application data and the Modbus network. </td></tr>
  </table>
</dl>
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000006">Deprecated:</a></b></dt><dd>This function is deprecated. The preferred way of assigning a dataTable is using the default constructor and configuring data table and slave address using addDataTable method. </dd></dl>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="MbusTcpSlaveProtocolz29_2" doxytag="MbusTcpSlaveProtocol::startupServer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int startupServer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Puts the Modbus server into operation. 
<p>
The server accepts connections on any interface.<p>
This function opens a TCP/IP socket, binds the configured TCP port to the Modbus/TCP protocol and initialises the server engine.<p>
<dl compact><dt><b>Note:</b></dt><dd>If the configured TCP port is below IPPORT_RESERVED (usually 1024), the process has to run with root privilege! </dd></dl>
<dl compact><dt><b>Returns:</b></dt><dd>FTALK_SUCCESS on success or error code. See <a class="el" href="group__buserror.html">Protocol Errors and Exceptions</a> for a list of error codes. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_3" doxytag="MbusTcpSlaveProtocol::startupServer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int startupServer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const char *const &nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>hostName</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Puts the Modbus server into operation. 
<p>
The server accepts connections only on the interfaces which match the supplied hostname or IP address. This method allows to run different servers on multiple interfaces (so called multihomed servers).<p>
This function opens a TCP/IP socket, binds the configured TCP port to the Modbus/TCP protocol and initialises the server engine.<p>
<dl compact><dt><b>Note:</b></dt><dd>If the configured TCP port is below IPPORT_RESERVED (usually 1024), the process has to run with root privilege! </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>hostName</em>&nbsp;</td><td>String with IP address for a specific host interface or NULL if connections are accepted on any interface </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>FTALK_SUCCESS on success or error code. See <a class="el" href="group__buserror.html">Protocol Errors and Exceptions</a> for a list of error codes. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_4" doxytag="MbusTcpSlaveProtocol::startupServer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int startupServer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>slaveAddr</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Puts the Modbus server into operation using a single slave address and data table. 
<p>
The server accepts connections on any interface.<p>
Function is kept for compatibility with previous API versions, do not use for new implementations.<p>
<dl compact><dt><b>Note:</b></dt><dd>If the configured TCP port is below IPPORT_RESERVED (usually 1024), the process has to run with root privilege! </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>slaveAddr</em>&nbsp;</td><td>Modbus slave address for server to listen on (-1 - 255). 0 is regarded as a valid value for a MODBUS/TCP server address. A value of -1 means the server disregards the slave address and listens to all slave addresses. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>FTALK_SUCCESS on success or error code. See <a class="el" href="group__buserror.html">Protocol Errors and Exceptions</a> for a list of error codes. </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000007">Deprecated:</a></b></dt><dd>This function is deprecated. The preferred way of assigning a slave address is using the default constructor and configuring data table and slave address using addDataTable method. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_5" doxytag="MbusTcpSlaveProtocol::startupServer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int startupServer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname" nowrap> <em>slaveAddr</em>, </td>
        </tr>
        <tr>
          <td class="md" nowrap align="right"></td>
          <td class="md"></td>
          <td class="md" nowrap>const char *const &nbsp;</td>
          <td class="mdname" nowrap> <em>hostName</em></td>
        </tr>
        <tr>
          <td class="md"></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Puts the Modbus server into operation using a single slave address and data table. 
<p>
Function is kept for compatibility with previous API versions, do not use for new implementations.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>slaveAddr</em>&nbsp;</td><td>Modbus slave address for server to listen on (-1 - 255). 0 is regarded as a valid value for a MODBUS/TCP server address. A value of -1 means the server disregards the slave address and listens to all slave addresses. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hostName</em>&nbsp;</td><td>String with IP address for a specific host interface or NULL if connections are accepted on any interface </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>FTALK_SUCCESS on success or error code. See <a class="el" href="group__buserror.html">Protocol Errors and Exceptions</a> for a list of error codes. </dd></dl>
<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000008">Deprecated:</a></b></dt><dd>This function is deprecated. The preferred way of assigning a slave address is using the default constructor and configuring data table and slave address using addDataTable method. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_6" doxytag="MbusTcpSlaveProtocol::shutdownServer"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void shutdownServer           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Shuts down the Modbus server. 
<p>
This function closes all TCP/IP connections to MODBUS/TCP masters and releases any system resources associated with the connections. 
<p>
Reimplemented from <a class="el" href="group__mbusslave.html#ga9">MbusSlaveServer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_7" doxytag="MbusTcpSlaveProtocol::serverLoop"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int serverLoop           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
MODBUS/TCP slave server loop. 
<p>
This server loop must be called continuously. It must not be blocked. The server has to be started before calling the <a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_7">serverLoop()</a> method. This server engine can handle multiple TCP/IP connections at the same time.<p>
<dl compact><dt><b>Returns:</b></dt><dd>FTALK_SUCCESS on success or error code. See <a class="el" href="group__buserror.html">Protocol Errors and Exceptions</a> for a list of error codes. </dd></dl>

<p>
Implements <a class="el" href="group__mbusslave.html#ga8">MbusSlaveServer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_8" doxytag="MbusTcpSlaveProtocol::isStarted"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int isStarted           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns if server has been started up. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>= started </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>= shutdown </td></tr>
  </table>
</dl>

<p>
Implements <a class="el" href="group__mbusslave.html#ga10">MbusSlaveServer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_9" doxytag="MbusTcpSlaveProtocol::getConnectionStatus"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int getConnectionStatus           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Checks if a Modbus master is polling periodically. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>true</em>&nbsp;</td><td>= A master is polling at a frequency higher than the master transmit time-out value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>false</em>&nbsp;</td><td>= No master is polling within the time-out period </td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>The master transmit time-out value must be set &gt; 0 in order for this function to work. </dd></dl>

<p>
Implements <a class="el" href="group__mbusslave.html#ga11">MbusSlaveServer</a>.    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_10" doxytag="MbusTcpSlaveProtocol::setPort"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">int setPort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned short&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>portNo</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Sets the TCP port number to be used by the protocol. 
<p>
<dl compact><dt><b>Remarks:</b></dt><dd>Usually the port number remains unchanged and defaults to 502. In this case no call to this function is necessary. However if the port number has to be different from 502 this function must be called <em>before</em> starting the server with <a class="el" href="classMbusTcpSlaveProtocol.html#MbusTcpSlaveProtocolz29_2">startupServer()</a>.</dd></dl>
<dl compact><dt><b>Note:</b></dt><dd>If the configured TCP port is below IPPORT_RESERVED (usually 1024), the process has to run with root privilege! </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>portNo</em>&nbsp;</td><td>Port number the server shall listen on </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>FTALK_SUCCESS</em>&nbsp;</td><td>Success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>FTALK_ILLEGAL_STATE_ERROR</em>&nbsp;</td><td>Server already running </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_11" doxytag="MbusTcpSlaveProtocol::installIpAddrValidationCallBack"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">void installIpAddrValidationCallBack           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int(*)(char *masterIpAddrSz)&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>f</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
This function installs a callback handler for validating a master's IP address. 
<p>
Pass a pointer to a function with checks a master's IP address and either accepts or rejects a master's connection.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>masterIpAddrSz</em>&nbsp;</td><td>IPv4 Internet host address string in the standard numbers-and-dots notation.</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>Returns 1 to accept a connection or 0 to reject it. </dd></dl>
    </td>
  </tr>
</table>
<a class="anchor" name="MbusTcpSlaveProtocolz29_12" doxytag="MbusTcpSlaveProtocol::getPort"></a><p>
<table class="mdTable" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top">unsigned short getPort           </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>
      </table>
    </td>
  </tr>
</table>
<table cellspacing="5" cellpadding="0" border="0">
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Returns the TCP port number used by the protocol. 
<p>
<dl compact><dt><b>Returns:</b></dt><dd>Port number used by the protocol </dd></dl>
    </td>
  </tr>
</table>
   <hr>
   <table width="100%" cellspacing=0 cellpadding=5 border=0>
      <tr>
         <td class=footer valign=top>
         Copyright &copy; 2002-2006 <a href="http://www.focus-sw.com">
         FOCUS Software Engineering Pty Ltd</a>, Australia.
         All rights reserved.
         <br>
         Please see the <a href="notices.html">Notices</a> page for trademark notices.
         <br>
         Last updated: 20 Oct 2006
     </tr>
   </table>

</body>
</html>

